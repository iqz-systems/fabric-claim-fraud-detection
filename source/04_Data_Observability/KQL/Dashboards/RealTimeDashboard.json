{
  "schema_version": "60",
  "tiles": [
    {
      "id": "ef7b6462-6139-4590-932b-eeaf5d0c4d72",
      "title": "Daily Ingestion Status by Table",
      "visualType": "table",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 0,
        "y": 10,
        "width": 14,
        "height": 7
      },
      "queryRef": {
        "kind": "query",
        "queryId": "9e6911c3-cfdb-4659-a2f1-265d0fe6db8b"
      },
      "visualOptions": {
        "table__enableRenderLinks": true,
        "colorRulesDisabled": false,
        "colorStyle": "light",
        "crossFilterDisabled": false,
        "drillthroughDisabled": false,
        "crossFilter": [],
        "drillthrough": [],
        "table__renderLinks": [],
        "colorRules": [
          {
            "id": "020ee0e9-3e49-45ba-8b4f-343d632d531a",
            "ruleType": "colorByCondition",
            "applyToColumn": null,
            "hideText": false,
            "applyTo": "cells",
            "conditions": [
              {
                "operator": "==",
                "column": "Status",
                "values": [
                  "Failed"
                ]
              }
            ],
            "chainingOperator": "or",
            "colorStyle": "bold",
            "color": "red",
            "tag": "",
            "icon": "critical",
            "ruleName": "",
            "visualType": "table"
          },
          {
            "id": "b6074985-e706-4304-a212-f7933e0e2d58",
            "ruleType": "colorByCondition",
            "applyToColumn": null,
            "hideText": false,
            "applyTo": "cells",
            "conditions": [
              {
                "operator": "==",
                "column": "Status",
                "values": [
                  "Succeeded"
                ]
              }
            ],
            "chainingOperator": "and",
            "colorStyle": "bold",
            "color": "green",
            "tag": "",
            "icon": "completed",
            "ruleName": "",
            "visualType": "table"
          }
        ]
      }
    },
    {
      "id": "d4f35048-0f22-4901-b797-b37deb5ed8c7",
      "title": "Query Volume Over Time",
      "visualType": "line",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 0,
        "y": 17,
        "width": 14,
        "height": 7
      },
      "queryRef": {
        "kind": "query",
        "queryId": "dd2c071f-d5c4-4288-9b6c-068a6ba8ccb4"
      },
      "visualOptions": {
        "multipleYAxes": {
          "base": {
            "id": "-1",
            "label": "",
            "columns": [],
            "yAxisMaximumValue": null,
            "yAxisMinimumValue": null,
            "yAxisScale": "linear",
            "horizontalLines": []
          },
          "additional": [],
          "showMultiplePanels": false
        },
        "hideLegend": false,
        "legendLocation": "bottom",
        "xColumnTitle": "",
        "xColumn": null,
        "yColumns": null,
        "seriesColumns": null,
        "xAxisScale": "linear",
        "verticalLine": "",
        "crossFilterDisabled": false,
        "drillthroughDisabled": false,
        "crossFilter": [],
        "drillthrough": [],
        "selectedDataOnLoad": {
          "all": true,
          "limit": 10
        }
      }
    },
    {
      "id": "8f11890c-7767-4619-ae1b-2f4a4b1def63",
      "title": "Table Load Volume Trends",
      "visualType": "line",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 10,
        "y": 3,
        "width": 14,
        "height": 7
      },
      "queryRef": {
        "kind": "query",
        "queryId": "9f36a90b-09f2-43cb-9860-d29155980f92"
      },
      "visualOptions": {
        "multipleYAxes": {
          "base": {
            "id": "-1",
            "label": "",
            "columns": [],
            "yAxisMaximumValue": null,
            "yAxisMinimumValue": null,
            "yAxisScale": "linear",
            "horizontalLines": []
          },
          "additional": [],
          "showMultiplePanels": false
        },
        "hideLegend": false,
        "legendLocation": "right",
        "xColumnTitle": "",
        "xColumn": null,
        "yColumns": null,
        "seriesColumns": null,
        "xAxisScale": "linear",
        "verticalLine": "",
        "crossFilterDisabled": false,
        "drillthroughDisabled": false,
        "crossFilter": [],
        "drillthrough": [],
        "selectedDataOnLoad": {
          "all": true,
          "limit": 10
        }
      }
    },
    {
      "id": "1127bb2a-07d1-4135-bafe-446b557b1614",
      "title": "Memory Usage Over Time",
      "visualType": "area",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 0,
        "y": 24,
        "width": 12,
        "height": 7
      },
      "queryRef": {
        "kind": "query",
        "queryId": "45163846-f909-42d0-8af6-9766e1bfac83"
      },
      "visualOptions": {
        "multipleYAxes": {
          "base": {
            "id": "-1",
            "label": "",
            "columns": [],
            "yAxisMaximumValue": null,
            "yAxisMinimumValue": null,
            "yAxisScale": "linear",
            "horizontalLines": []
          },
          "additional": [],
          "showMultiplePanels": false
        },
        "hideLegend": false,
        "legendLocation": "bottom",
        "xColumnTitle": "",
        "xColumn": null,
        "yColumns": null,
        "seriesColumns": null,
        "xAxisScale": "linear",
        "verticalLine": "",
        "crossFilterDisabled": false,
        "drillthroughDisabled": false,
        "crossFilter": [],
        "drillthrough": [],
        "selectedDataOnLoad": {
          "all": true,
          "limit": 10
        }
      }
    },
    {
      "id": "0675f90f-ea26-4bfd-8517-e8f43379e857",
      "title": "CPU Usage Over Time",
      "visualType": "timechart",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 13,
        "y": 24,
        "width": 11,
        "height": 7
      },
      "queryRef": {
        "kind": "query",
        "queryId": "cff761cb-7554-4b27-a539-e85b97de16cf"
      },
      "visualOptions": {
        "xColumn": null,
        "multipleYAxes": {
          "additional": [],
          "showMultiplePanels": false,
          "base": {
            "horizontalLines": [],
            "yAxisScale": "linear",
            "yAxisMaximumValue": null,
            "yAxisMinimumValue": null,
            "columns": [],
            "label": "",
            "id": "-1"
          }
        },
        "yColumns": null,
        "seriesColumns": null,
        "anomalyColumns": null,
        "map__latitudeColumn": null,
        "map__longitudeColumn": null,
        "selectedDataOnLoad": {
          "all": true,
          "limit": 10
        }
      }
    },
    {
      "id": "461897bb-0974-4be6-9f3d-15b25c966e0b",
      "title": "Freshness Status",
      "visualType": "table",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 0,
        "y": 3,
        "width": 9,
        "height": 7
      },
      "queryRef": {
        "kind": "query",
        "queryId": "482e05fa-149f-4afc-879e-90bddc430569"
      },
      "visualOptions": {
        "table__enableRenderLinks": true,
        "colorRulesDisabled": false,
        "colorStyle": "light",
        "crossFilterDisabled": false,
        "drillthroughDisabled": false,
        "crossFilter": [],
        "drillthrough": [],
        "table__renderLinks": [],
        "colorRules": [
          {
            "id": "4398626f-0519-4bc7-8bac-2e1430a074af",
            "ruleType": "colorByCondition",
            "applyToColumn": null,
            "hideText": false,
            "applyTo": "cells",
            "conditions": [
              {
                "operator": "==",
                "column": "Status",
                "values": [
                  "Critical"
                ]
              }
            ],
            "chainingOperator": "or",
            "colorStyle": "bold",
            "color": "red",
            "tag": "",
            "icon": "warning",
            "ruleName": "",
            "visualType": "table"
          },
          {
            "id": "23e14cc9-ee69-4c1c-b25e-47fc98ab43e3",
            "ruleType": "colorByCondition",
            "applyToColumn": null,
            "hideText": false,
            "applyTo": "cells",
            "conditions": [
              {
                "operator": "==",
                "column": "Status",
                "values": [
                  "Fresh"
                ]
              }
            ],
            "chainingOperator": "and",
            "colorStyle": "bold",
            "color": "green",
            "tag": "",
            "icon": "completed",
            "ruleName": "",
            "visualType": "table"
          }
        ]
      }
    },
    {
      "id": "0efcf158-e365-413c-82d1-0fe415558dd2",
      "title": "Schema Change",
      "visualType": "table",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 15,
        "y": 10,
        "width": 9,
        "height": 7
      },
      "queryRef": {
        "kind": "query",
        "queryId": "b8eacbfc-1ce2-442a-8b8d-c5856005ba8b"
      },
      "visualOptions": {
        "selectedDataOnLoad": {
          "all": true,
          "limit": 10
        }
      }
    },
    {
      "id": "f8f4f4d7-e636-493c-acfb-14e93f1b8825",
      "title": "Top Users By Query Count",
      "visualType": "column",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 15,
        "y": 17,
        "width": 9,
        "height": 7
      },
      "queryRef": {
        "kind": "query",
        "queryId": "ad7f0746-22c6-492b-8df4-02aa2d3874a6"
      },
      "visualOptions": {
        "multipleYAxes": {
          "base": {
            "id": "-1",
            "label": "",
            "columns": [],
            "yAxisMaximumValue": null,
            "yAxisMinimumValue": null,
            "yAxisScale": "linear",
            "horizontalLines": []
          },
          "additional": [],
          "showMultiplePanels": false
        },
        "hideLegend": false,
        "legendLocation": "bottom",
        "xColumnTitle": "",
        "xColumn": null,
        "yColumns": null,
        "seriesColumns": null,
        "xAxisScale": "linear",
        "verticalLine": "",
        "crossFilterDisabled": false,
        "drillthroughDisabled": false,
        "crossFilter": [],
        "drillthrough": [],
        "selectedDataOnLoad": {
          "all": true,
          "limit": 10
        }
      }
    },
    {
      "id": "dde5dd45-1646-4427-a08b-1a37b3ce7b56",
      "title": "CPU Usage",
      "visualType": "table",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 0,
        "y": 31,
        "width": 18,
        "height": 6
      },
      "queryRef": {
        "kind": "query",
        "queryId": "93462a97-1be2-40d2-b206-28466992ef7f"
      },
      "visualOptions": {
        "table__enableRenderLinks": true,
        "colorRulesDisabled": false,
        "colorStyle": "light",
        "crossFilterDisabled": false,
        "drillthroughDisabled": false,
        "crossFilter": [],
        "drillthrough": [],
        "table__renderLinks": [],
        "colorRules": [
          {
            "id": "ded06f69-7017-4779-b34f-2cf5c3e28abf",
            "ruleType": "colorByCondition",
            "applyToColumn": null,
            "hideText": false,
            "applyTo": "cells",
            "conditions": [
              {
                "operator": "==",
                "column": "Status",
                "values": [
                  "Succeeded"
                ]
              }
            ],
            "chainingOperator": "and",
            "colorStyle": "bold",
            "color": "green",
            "tag": "",
            "icon": "completed",
            "ruleName": "",
            "visualType": "table"
          },
          {
            "id": "c6a07ea3-28ba-482c-9903-ce4044d6bd77",
            "ruleType": "colorByCondition",
            "applyToColumn": null,
            "hideText": false,
            "applyTo": "cells",
            "conditions": [
              {
                "operator": "==",
                "column": "Status",
                "values": [
                  "Failed"
                ]
              }
            ],
            "chainingOperator": "and",
            "colorStyle": "bold",
            "color": "red",
            "tag": "",
            "icon": "warning",
            "ruleName": "",
            "visualType": "table"
          }
        ],
        "selectedDataOnLoad": {
          "all": true,
          "limit": 10
        }
      }
    },
    {
      "id": "212b6438-3fc1-45da-9bcb-6a61882e917a",
      "title": "Freshness Health",
      "visualType": "card",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 7,
        "y": 0,
        "width": 4,
        "height": 3
      },
      "queryRef": {
        "kind": "query",
        "queryId": "9640a088-d51e-429d-a88b-8bbaf87e8c1a"
      },
      "visualOptions": {
        "multiStat__textSize": "auto",
        "multiStat__valueColumn": null,
        "colorRulesDisabled": false,
        "colorStyle": "light",
        "colorRules": []
      }
    },
    {
      "id": "63ccf855-aa98-4b3c-9e39-245b22015926",
      "title": "Schema Health",
      "visualType": "card",
      "pageId": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e",
      "layout": {
        "x": 12,
        "y": 0,
        "width": 4,
        "height": 3
      },
      "queryRef": {
        "kind": "query",
        "queryId": "03f3db5d-19f1-4ac2-aab0-68b08e09de75"
      },
      "visualOptions": {
        "multiStat__textSize": "auto",
        "multiStat__valueColumn": null,
        "colorRulesDisabled": false,
        "colorStyle": "light",
        "colorRules": []
      }
    }
  ],
  "baseQueries": [],
  "parameters": [
    {
      "kind": "duration",
      "id": "5af461fc-68be-4eb0-a4a3-9a40eac61058",
      "displayName": "Time range",
      "description": "",
      "beginVariableName": "_startTime",
      "endVariableName": "_endTime",
      "defaultValue": {
        "kind": "dynamic",
        "count": 1,
        "unit": "hours"
      },
      "showOnPages": {
        "kind": "all"
      }
    }
  ],
  "dataSources": [
    {
      "id": "2116211c-a38e-48be-be10-19734fd0f591",
      "kind": "kusto-trident",
      "scopeId": "kusto-trident",
      "clusterUri": "",
      "database": "96facb72-dd75-82a0-496e-1bf115aff39e",
      "name": "Claims_EventHouse",
      "workspace": "00000000-0000-0000-0000-000000000000"
    },
    {
      "kind": "kusto-trident",
      "scopeId": "kusto-trident",
      "clusterUri": "https://trd-361tu3vjzdeughdhwe.z6.kusto.fabric.microsoft.com",
      "database": "690e2d09-6296-4643-982c-50e3f294447e",
      "name": "Monitoring Eventhouse",
      "workspace": "8763c8ae-5c1f-4ab1-bfac-462b498ab172",
      "id": "3ae54586-7e79-4e36-8413-221a6559a737"
    }
  ],
  "pages": [
    {
      "name": "Page 1",
      "id": "d1cd3844-6c97-4f3c-8e96-ab238094bb1e"
    }
  ],
  "queries": [
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "// Daily Ingestion Status by Table\nEventhouseIngestionResultsLogs\n| where Timestamp > ago(30d)\n| summarize Count = count() by bin(Timestamp, 1d), TableName, Status, IngestionErrorDetails\n| sort by Timestamp desc",
      "id": "9e6911c3-cfdb-4659-a2f1-265d0fe6db8b",
      "usedVariables": []
    },
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "EventhouseQueryLogs\r\n| where Timestamp > ago(30d)\r\n| summarize QueryCount = count() by bin(Timestamp, 1h), Status\r\n| sort by Timestamp desc",
      "id": "dd2c071f-d5c4-4288-9b6c-068a6ba8ccb4",
      "usedVariables": []
    },
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "EventhouseDataOperationLogs\r\n| where Timestamp > ago(25d)\r\n| summarize TotalRows = sum(TotalRowsCount) by bin(Timestamp, 1d), TableName",
      "id": "9f36a90b-09f2-43cb-9860-d29155980f92",
      "usedVariables": []
    },
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "EventhouseCommandLogs\r\n| where Timestamp > ago(30d)\r\n| summarize PeakMemory = max(MemoryPeakBytes) by bin(Timestamp, 1h)\r\n",
      "id": "45163846-f909-42d0-8af6-9766e1bfac83",
      "usedVariables": []
    },
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "EventhouseCommandLogs\r\n| where Timestamp > ago(30d)\r\n| summarize AvgCpuMs = avg(CpuTimeMs) by bin(Timestamp, 1h)\r\n| render timechart\r\n",
      "id": "cff761cb-7554-4b27-a539-e85b97de16cf",
      "usedVariables": []
    },
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "let LookBackPeriod = 7d;\r\nEventhouseIngestionResultsLogs\r\n| where Timestamp > ago(20d)\r\n| summarize LastIngestion = max(Timestamp) by TableName\r\n| extend Status = iff(LastIngestion >= ago(LookBackPeriod), \"Fresh\", \"Critical\")\r\n| project TableName, LastIngestion, Status\r\n| order by LastIngestion desc\r\n",
      "id": "482e05fa-149f-4afc-879e-90bddc430569",
      "usedVariables": []
    },
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "EventhouseQueryLogs\n| where Timestamp > ago(30d)\n  and isnotempty(QueryText)\n  and QueryText has_any (\n        \".alter table\", \n        \".create table\", \n        \".drop table\", \n        \".rename table\", \n        \".alter column\", \n        \".drop column\", \n        \".add column\",\n        \".create-or-alter table\"\n    )\n| project\n    Timestamp,\n    DatabaseName,\n    Identity,\n    QueryText,\n    Status\n| sort by Timestamp desc\n",
      "id": "b8eacbfc-1ce2-442a-8b8d-c5856005ba8b",
      "usedVariables": []
    },
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "//Top X Users by Query Count in selected databases in past 30 days \nlet Duration =timespan(30); \nlet Topcount=10; \nlet _DatabaseName = dynamic(['Claims_EventHouse']); \nEventhouseQueryLogs \n| where Timestamp > ago (Duration) \n| where isempty(['_DatabaseName']) or DatabaseName in (['_DatabaseName']) \n|extend UPN=todynamic(tostring(Identity)).claims.upn , AppId=todynamic(tostring(Identity)).claims.AppId \n|extend User=tostring(iff(isempty(UPN), AppId, UPN)), PrincipalUserType=iff(isempty(UPN), \"Application\", \"User\") \n|summarize QueryCount=count() by User\n|top Topcount by QueryCount",
      "id": "ad7f0746-22c6-492b-8df4-02aa2d3874a6",
      "usedVariables": []
    },
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "EventhouseCommandLogs\n| where Timestamp > ago(30d)\n| top 10 by CpuTimeMs desc\n| project Timestamp,DatabaseName, CommandText, CpuTimeMs, DurationMs,FailureReason, Status",
      "id": "93462a97-1be2-40d2-b206-28466992ef7f",
      "usedVariables": []
    },
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "let LookBackPeriod = 7d;\nEventhouseIngestionResultsLogs\n| where Timestamp > ago(20d)\n| summarize LastIngestion = max(Timestamp) by TableName\n| extend Status = iff(LastIngestion >= ago(LookBackPeriod), \"Fresh\", \"Critical\")\n| summarize CriticalCount = countif(Status == \"Critical\")\n",
      "id": "9640a088-d51e-429d-a88b-8bbaf87e8c1a",
      "usedVariables": []
    },
    {
      "dataSource": {
        "kind": "inline",
        "dataSourceId": "3ae54586-7e79-4e36-8413-221a6559a737"
      },
      "text": "EventhouseQueryLogs\r\n| where Timestamp > ago(30d)\r\n  and isnotempty(QueryText)\r\n  and QueryText has_any (\r\n        \".alter table\", \r\n        \".create table\", \r\n        \".drop table\", \r\n        \".rename table\", \r\n        \".alter column\", \r\n        \".drop column\", \r\n        \".add column\",\r\n        \".create-or-alter table\"\r\n    )\r\n| summarize SchemaChangeCount = count()\r\n",
      "id": "03f3db5d-19f1-4ac2-aab0-68b08e09de75",
      "usedVariables": []
    }
  ]
}